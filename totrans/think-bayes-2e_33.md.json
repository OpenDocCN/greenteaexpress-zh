["```py\np0, p1 = 0.66, 0.5 \n```", "```py\ndef compute_probs(p0, p1):\n  \"\"\"Computes the probability for each of 4 categories.\"\"\"\n    q0 = 1-p0\n    q1 = 1-p1\n    return [q0*q1, q0*p1, p0*q1, p0*p1] \n```", "```py\ny = compute_probs(p0, p1)\ny \n```", "```py\n[0.16999999999999998, 0.16999999999999998, 0.33, 0.33] \n```", "```py\nfrom utils import make_poisson_pmf\n\nqs = np.arange(0, 11) \nlam = 2\nprior_N = make_poisson_pmf(lam, qs)\nprior_N.index.name = 'N'\nprior_N.mean() \n```", "```py\n1.9999236196641172 \n```", "```py\nprior_N.plot(color='C7')\n\ndecorate(xlabel='Number of typos (N)',\n         ylabel='PMF',\n         title='Prior distribution') \n```", "```py\nk10 = 1\nk01 = 1\nk11 = 0 \n```", "```py\ndata = np.array([0, k01, k10, k11]) \n```", "```py\nfrom scipy.stats import multinomial\n\nlikelihood = prior_N.copy()\nobserved = data.sum()\nx = data.copy()\n\nfor N in prior_N.qs:\n    x[0] = N - observed\n    likelihood[N] = multinomial.pmf(x, N, y) \n```", "```py\nposterior_N = prior_N * likelihood\nposterior_N.normalize() \n```", "```py\n0.0426675416210306 \n```", "```py\nprior_N.plot(color='C7', alpha=0.4, label='prior')\nposterior_N.plot(color='C4', label='posterior')\n\ndecorate(xlabel='Number of typos (N)',\n         ylabel='PMF',\n         title='Prior distribution') \n```", "```py\nprint(posterior_N.mean(), \n      posterior_N.credible_interval(0.9)) \n```", "```py\n2.3399999989281604 [2\\. 3.] \n```", "```py\nfrom empiricaldist import Pmf\nfrom scipy.stats import beta as beta_dist\n\ndef make_beta(qs, alpha, beta, name=\"\"):\n    ps = beta_dist.pdf(qs, alpha, beta)\n    pmf = Pmf(ps, qs)\n    pmf.normalize()\n    pmf.index.name = name\n    return pmf \n```", "```py\nqs = np.linspace(0, 1, num=51)\nprior_p0 = make_beta(qs, 3, 2, name='p0')\nprior_p1 = make_beta(qs, 2, 2, name='p1') \n```", "```py\nprior_p0.plot()\nprior_p1.plot()\n\ndecorate(xlabel='Probability of finding a typo',\n         ylabel='PMF',\n         title='Prior distributions') \n```", "```py\nfrom utils import make_joint\n\njoint2 = make_joint(prior_p0, prior_N)\njoint2.shape \n```", "```py\n(11, 51) \n```", "```py\njoint2_pmf = Pmf(joint2.stack())\njoint2_pmf.head(3) \n```", "```py\njoint3 = make_joint(prior_p1, joint2_pmf)\njoint3.shape \n```", "```py\n(561, 51) \n```", "```py\njoint3.head(3) \n```", "```py\njoint3_pmf = Pmf(joint3.stack())\njoint3_pmf.head(3) \n```", "```py\njoint3_pmf.shape \n```", "```py\n(28611,) \n```", "```py\nlikelihood = joint3_pmf.copy()\nobserved = data.sum()\nx = data.copy()\n\nfor N, p0, p1 in joint3_pmf.index:\n    x[0] = N - observed\n    y = compute_probs(p0, p1)\n    likelihood[N, p0, p1] = multinomial.pmf(x, N, y) \n```", "```py\n/home/downey/miniconda3/envs/ThinkBayes2/lib/python3.10/site-packages/scipy/stats/_multivariate.py:3190: RuntimeWarning: invalid value encountered in subtract\n  return gammaln(n+1) + np.sum(xlogy(x, p) - gammaln(x+1), axis=-1) \n```", "```py\nposterior_pmf = joint3_pmf * likelihood\nposterior_pmf.normalize() \n```", "```py\n0.03437554251769621 \n```", "```py\nposterior_N = posterior_pmf.marginal(0) \n```", "```py\nprior_N.plot(color='C7', alpha=0.4, label='prior')\nposterior_N.plot(color='C4', label='posterior')\n\ndecorate(xlabel='Number of bugs (N)',\n         ylabel='PDF',\n         title='Posterior marginal distributions of N') \n```", "```py\nposterior_N.make_surv()[observed] \n```", "```py\n0.369576444173048 \n```", "```py\nposterior_N.mean() \n```", "```py\n2.4963989774563107 \n```", "```py\nposterior_p1 = posterior_pmf.marginal(1)\nposterior_p2 = posterior_pmf.marginal(2)\n\nposterior_p1.plot(label='p1')\nposterior_p2.plot(label='p2')\n\ndecorate(xlabel='Probability of finding a bug',\n         ylabel='PDF',\n         title='Posterior marginal distributions of p1 and p2') \n```", "```py\nposterior_p1.mean(), posterior_p1.credible_interval(0.9) \n```", "```py\n(0.5383375553393667, array([0.24, 0.82])) \n```", "```py\nposterior_p2.mean(), posterior_p2.credible_interval(0.9) \n```", "```py\n(0.46718395159883724, array([0.16, 0.78])) \n```", "```py\nk10 = 0\nk01 = 0\nk11 = 1 \n```"]
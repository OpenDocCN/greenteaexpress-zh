- en: Conjugate Priors
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 共轭先验
- en: 原文：[https://allendowney.github.io/ThinkBayes2/chap18.html](https://allendowney.github.io/ThinkBayes2/chap18.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://allendowney.github.io/ThinkBayes2/chap18.html](https://allendowney.github.io/ThinkBayes2/chap18.html)
- en: In the previous chapters we have used grid approximations to solve a variety
    of problems. One of my goals has been to show that this approach is sufficient
    to solve many real-world problems. And I think it’s a good place to start because
    it shows clearly how the methods work.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在之前的章节中，我们已经使用网格近似来解决各种问题。我其中一个目标是要表明这种方法足以解决许多现实世界的问题。我认为这是一个很好的开始，因为它清楚地展示了这些方法的工作原理。
- en: However, as we saw in the previous chapter, grid methods will only get you so
    far. As we increase the number of parameters, the number of points in the grid
    grows (literally) exponentially. With more than 3-4 parameters, grid methods become
    impractical.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，正如我们在上一章中看到的，网格方法只能帮你走得更远。随着参数数量的增加，网格中的点数（字面上）呈指数级增长。对于超过3-4个参数，网格方法变得不切实际。
- en: 'So, in the remaining three chapters, I will present three alternatives:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，在剩下的三章中，我将提出三种替代方案：
- en: In this chapter we’ll use **conjugate priors** to speed up some of the computations
    we’ve already done.
  id: totrans-5
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在本章中，我们将使用**共轭先验**来加速我们已经完成的一些计算。
- en: In the next chapter, I’ll present Markov chain Monte Carlo (MCMC) methods, which
    can solve problems with tens of parameters, or even hundreds, in a reasonable
    amount of time.
  id: totrans-6
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在下一章中，我将介绍马尔可夫链蒙特卡洛（MCMC）方法，它可以在合理的时间内解决具有数十个甚至数百个参数的问题。
- en: And in the last chapter we’ll use Approximate Bayesian Computation (ABC) for
    problems that are hard to model with simple distributions.
  id: totrans-7
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在最后一章中，我们将使用近似贝叶斯计算（ABC）来解决难以用简单分布建模的问题。
- en: We’ll start with the World Cup problem.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将从世界杯问题开始。
- en: The World Cup Problem Revisited
  id: totrans-9
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 重新审视世界杯问题
- en: In <<_PoissonProcesses>>, we solved the World Cup problem using a Poisson process
    to model goals in a soccer game as random events that are equally likely to occur
    at any point during a game.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在<<_PoissonProcesses>>中，我们使用泊松过程解决了世界杯问题，将足球比赛中的进球建模为随机事件，这些事件在比赛的任何时间点都同样可能发生。
- en: We used a gamma distribution to represent the prior distribution of \(\lambda\),
    the goal-scoring rate. And we used a Poisson distribution to compute the probability
    of \(k\), the number of goals scored.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用gamma分布来表示\(\lambda\)的先验分布，即进球率。我们使用泊松分布来计算\(k\)的概率，即进球数。
- en: Here’s a gamma object that represents the prior distribution.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 这是代表先验分布的gamma对象。
- en: '[PRE0]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: And here’s a grid approximation.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个网格近似。
- en: '[PRE1]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Here’s the likelihood of scoring 4 goals for each possible value of `lam`.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 这是对于每个可能的`lam`值得分4个目标的可能性。
- en: '[PRE2]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: And here’s the update.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 这是更新的方法。
- en: '[PRE3]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '[PRE4]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: So far, this should be familiar. Now we’ll solve the same problem using the
    conjugate prior.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，这应该是熟悉的。现在我们将使用共轭先验来解决相同的问题。
- en: The Conjugate Prior
  id: totrans-22
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 共轭先验
- en: In <<_TheGammaDistribution>>, I presented three reasons to use a gamma distribution
    for the prior and said there was a fourth reason I would reveal later. Well, now
    is the time.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在<<_TheGammaDistribution>>中，我提出了使用gamma分布作为先验的三个原因，并说有第四个原因我将稍后揭示。现在是时候了。
- en: The other reason I chose the gamma distribution is that it is the “conjugate
    prior” of the Poisson distribution, so-called because the two distributions are
    connected or coupled, which is what “conjugate” means.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 我选择gamma分布的另一个原因是它是泊松分布的“共轭先验”，所谓的共轭是因为这两个分布是相连的或耦合的，这就是“共轭”的含义。
- en: In the next section I’ll explain *how* they are connected, but first I’ll show
    you the consequence of this connection, which is that there is a remarkably simple
    way to compute the posterior distribution.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我将解释它们是如何相连的，但首先我将向你展示这种联系的后果，即计算后验分布有一个非常简单的方法。
- en: However, in order to demonstrate it, we have to switch from the one-parameter
    version of the gamma distribution to the two-parameter version. Since the first
    parameter is called `alpha`, you might guess that the second parameter is called
    `beta`.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 但是，为了演示它，我们必须从gamma分布的单参数版本切换到双参数版本。由于第一个参数称为`alpha`，你可能会猜到第二个参数称为`beta`。
- en: The following function takes `alpha` and `beta` and makes an object that represents
    a gamma distribution with those parameters.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 以下函数接受`alpha`和`beta`，并创建一个代表具有这些参数的gamma分布的对象。
- en: '[PRE5]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Here’s the prior distribution with `alpha=1.4` again and `beta=1`.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 这是先验分布，其中`alpha=1.4`，`beta=1`。
- en: '[PRE6]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '[PRE7]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Now I claim without proof that we can do a Bayesian update with `k` goals just
    by making a gamma distribution with parameters `alpha+k` and `beta+1`.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我声称，我们可以通过使用参数为`alpha+k`和`beta+1`的gamma分布来进行`k`个目标的贝叶斯更新，尽管没有证明。
- en: '[PRE8]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Here’s how we update it with `k=4` goals in `t=1` game.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我们在`t=1`场比赛中用`k=4`个目标更新的方法。
- en: '[PRE9]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: After all the work we did with the grid, it might seem absurd that we can do
    a Bayesian update by adding two pairs of numbers. So let’s confirm that it works.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们用网格做的所有工作之后，我们可能会觉得通过添加两对数字来进行贝叶斯更新是荒谬的。所以让我们确认它是否有效。
- en: I’ll make a `Pmf` with a discrete approximation of the posterior distribution.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 我将使用离散近似的后验分布来创建一个`Pmf`。
- en: '[PRE10]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: The following figure shows the result along with the posterior we computed using
    the grid algorithm.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 下图显示了使用网格算法计算的结果以及我们计算的后验分布。
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格内容隐藏代码单元格内容</summary>
- en: '[PRE11]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell source Hide code cell source</summary>'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE11]</details> <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格源代码隐藏代码单元格源代码</summary>'
- en: '[PRE12]</details> ![_images/39ff697e7662f79c15a8ae461ced3925ebe82de05318674e35232f7e65030af6.png](../Images/6eed57e32a4a8ae310cfa4205aaaacf9.png)'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE12]</details> ![_images/39ff697e7662f79c15a8ae461ced3925ebe82de05318674e35232f7e65030af6.png](../Images/6eed57e32a4a8ae310cfa4205aaaacf9.png)'
- en: They are the same other than small differences due to floating-point approximations.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '[PRE14]</details>'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
- en: What the Actual?
  id: totrans-47
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To understand how that works, we’ll write the PDF of the gamma prior and the
    PMF of the Poisson likelihood, then multiply them together, because that’s what
    the Bayesian update does. We’ll see that the result is a gamma distribution, and
    we’ll derive its parameters.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
- en: 'Here’s the PDF of the gamma prior, which is the probability density for each
    value of \(\lambda\), given parameters \(\alpha\) and \(\beta\):'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
- en: \[\lambda^{\alpha-1} e^{-\lambda \beta}\]
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
- en: I have omitted the normalizing factor; since we are planning to normalize the
    posterior distribution anyway, we don’t really need it.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
- en: Now suppose a team scores \(k\) goals in \(t\) games. The probability of this
    data is given by the PMF of the Poisson distribution, which is a function of \(k\)
    with \(\lambda\) and \(t\) as parameters.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
- en: \[\lambda^k e^{-\lambda t}\]
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
- en: Again, I have omitted the normalizing factor, which makes it clearer that the
    gamma and Poisson distributions have the same functional form. When we multiply
    them together, we can pair up the factors and add up the exponents. The result
    is the unnormalized posterior distribution,
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
- en: \[\lambda^{\alpha-1+k} e^{-\lambda(\beta + t)}\]
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
- en: which we can recognize as an unnormalized gamma distribution with parameters
    \(\alpha + k\) and \(\beta + t\).
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
- en: 'This derivation provides insight into what the parameters of the posterior
    distribution mean: \(\alpha\) reflects the number of events that have occurred;
    \(\beta\) reflects the elapsed time.'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
- en: Binomial Likelihood
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'As a second example, let’s look again at the Euro problem. When we solved it
    with a grid algorithm, we started with a uniform prior:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: We used the binomial distribution to compute the likelihood of the data, which
    was 140 heads out of 250 attempts.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Then we computed the posterior distribution in the usual way.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: <details class="hide below-input"><summary aria-label="Toggle hidden content">Show
    code cell output Hide code cell output</summary>
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]</details>'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
- en: We can solve this problem more efficiently using the conjugate prior of the
    binomial distribution, which is the beta distribution.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
- en: The beta distribution is bounded between 0 and 1, so it works well for representing
    the distribution of a probability like `x`. It has two parameters, called `alpha`
    and `beta`, that determine the shape of the distribution.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
- en: SciPy provides an object called `beta` that represents a beta distribution.
    The following function takes `alpha` and `beta` and returns a new `beta` object.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'It turns out that the uniform distribution, which we used as a prior, is the
    beta distribution with parameters `alpha=1` and `beta=1`. So we can make a `beta`
    object that represents a uniform distribution, like this:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Now let’s figure out how to do the update. As in the previous example, we’ll
    write the PDF of the prior distribution and the PMF of the likelihood function,
    and multiply them together. We’ll see that the product has the same form as the
    prior, and we’ll derive its parameters.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
- en: Here is the PDF of the beta distribution, which is a function of \(x\) with
    \(\alpha\) and \(\beta\) as parameters.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
- en: \[x^{\alpha-1} (1-x)^{\beta-1}\]
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
- en: Again, I have omitted the normalizing factor, which we don’t need because we
    are going to normalize the distribution after the update.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
- en: And here’s the PMF of the binomial distribution, which is a function of \(k\)
    with \(n\) and \(x\) as parameters.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
- en: \[x^{k} (1-x)^{n-k}\]
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
- en: Again, I have omitted the normalizing factor. Now when we multiply the beta
    prior and the binomial likelihood, the result is
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
- en: \[x^{\alpha-1+k} (1-x)^{\beta-1+n-k}\]
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
- en: which we recognize as an unnormalized beta distribution with parameters \(\alpha+k\)
    and \(\beta+n-k\).
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
- en: 'So if we observe `k` successes in `n` trials, we can do the update by making
    a beta distribution with parameters `alpha+k` and `beta+n-k`. That’s what this
    function does:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，如果我们观察到在n次试验中有k次成功，我们可以通过使用参数为`alpha+k`和`beta+n-k`的贝塔分布来进行更新。这就是这个函数的作用：
- en: '[PRE21]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: Again, the conjugate prior gives us insight into the meaning of the parameters;
    \(\alpha\) is related to the number of observed successes; \(\beta\) is related
    to the number of failures.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 再次，共轭先验使我们能够洞察参数的含义；\(\alpha\)与观察到的成功次数有关；\(\beta\)与失败次数有关。
- en: Here’s how we do the update with the observed data.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我们如何使用观察到的数据进行更新。
- en: '[PRE22]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: To confirm that it works, I’ll evaluate the posterior distribution for the possible
    values of `xs` and put the results in a `Pmf`.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 为了确认它是否有效，我将评估`xs`的可能值的后验分布，并将结果放入`Pmf`中。
- en: '[PRE23]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: And we can compare the posterior distribution we just computed with the results
    from the grid algorithm.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以将我们刚刚计算的后验分布与网格算法的结果进行比较。
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格内容
    隐藏代码单元格内容</summary>
- en: '[PRE24]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell source Hide code cell source</summary>'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE24]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">显示代码单元格源代码 隐藏代码单元格源代码</summary>'
- en: '[PRE25]</details> ![_images/6690cfacd465eb40d9ec441a2922b3fdf2f2f9656494ba5973edb6e05280cb97.png](../Images/abc447a9fedcb77f484b279731c683b2.png)'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE25]</details> ![_images/6690cfacd465eb40d9ec441a2922b3fdf2f2f9656494ba5973edb6e05280cb97.png](../Images/abc447a9fedcb77f484b279731c683b2.png)'
- en: They are the same other than small differences due to floating-point approximations.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 它们除了由于浮点近似而产生的小差异外是相同的。
- en: The examples so far are problems we have already solved, so let’s try something
    new.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止的例子都是我们已经解决的问题，所以让我们尝试一些新的东西。
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格内容
    隐藏代码单元格内容</summary>
- en: '[PRE26]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '[PRE27]</details>'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE27]</details>'
- en: Lions and Tigers and Bears
  id: totrans-98
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 狮子和老虎和熊
- en: Suppose we visit a wild animal preserve where we know that the only animals
    are lions and tigers and bears, but we don’t know how many of each there are.
    During the tour, we see 3 lions, 2 tigers, and one bear. Assuming that every animal
    had an equal chance to appear in our sample, what is the probability that the
    next animal we see is a bear?
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们参观一个野生动物保护区，在那里我们知道唯一的动物是狮子和老虎和熊，但我们不知道每种动物的数量。在游览期间，我们看到3只狮子，2只老虎和一只熊。假设每只动物有相等的机会出现在我们的样本中，那么我们下一次看到的动物是熊的概率是多少？
- en: To answer this question, we’ll use the data to estimate the prevalence of each
    species, that is, what fraction of the animals belong to each species. If we know
    the prevalences, we can use the multinomial distribution to compute the probability
    of the data. For example, suppose we know that the fraction of lions, tigers,
    and bears is 0.4, 0.3, and 0.3, respectively.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 为了回答这个问题，我们将使用数据来估计每个物种的盛行率，也就是说，动物中属于每个物种的比例。如果我们知道盛行率，我们可以使用多项分布来计算数据的概率。例如，假设我们知道狮子、老虎和熊的比例分别为0.4、0.3和0.3。
- en: 'In that case the probability of the data is:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，数据的概率是：
- en: '[PRE28]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '[PRE29]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Now, we could choose a prior for the prevalences and do a Bayesian update using
    the multinomial distribution to compute the probability of the data.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以为盛行率选择一个先验，并使用多项分布进行贝叶斯更新，计算数据的概率。
- en: 'But there’s an easier way, because the multinomial distribution has a conjugate
    prior: the Dirichlet distribution.'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 但有一个更简单的方法，因为多项分布有一个共轭先验：狄利克雷分布。
- en: The Dirichlet Distribution
  id: totrans-106
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 狄利克雷分布
- en: The Dirichlet distribution is a multivariate distribution, like the multivariate
    normal distribution we used in <<_MultivariateNormalDistribution>> to describe
    the distribution of penguin measurements.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 狄利克雷分布是一个多元分布，就像我们在<<_MultivariateNormalDistribution>>中使用的多元正态分布来描述企鹅测量的分布。
- en: In that example, the quantities in the distribution are pairs of flipper length
    and culmen length, and the parameters of the distribution are a vector of means
    and a matrix of covariances.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，分布中的数量是脚蹼长度和喙长度的对，分布的参数是均值向量和协方差矩阵。
- en: In a Dirichlet distribution, the quantities are vectors of probabilities, \(\mathbf{x}\),
    and the parameter is a vector, \(\mathbf{\alpha}\).
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 在狄利克雷分布中，数量是概率向量\(\mathbf{x}\)，参数是向量\(\mathbf{\alpha}\)。
- en: An example will make that clearer. SciPy provides a `dirichlet` object that
    represents a Dirichlet distribution. Here’s an instance with \(\mathbf{\alpha}
    = 1, 2, 3\).
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 一个例子会让这一点更清楚。SciPy提供了一个`dirichlet`对象，表示狄利克雷分布。这是一个实例，\(\mathbf{\alpha} = 1,
    2, 3\)。
- en: '[PRE30]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'Since we provided three parameters, the result is a distribution of three variables.
    If we draw a random value from this distribution, like this:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们提供了三个参数，结果是三个变量的分布。如果我们从这个分布中随机抽取一个值，就像这样：
- en: '[PRE31]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: '[PRE32]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格内容
    隐藏代码单元格内容</summary>
- en: '[PRE33]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: '[PRE34]</details>'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE34]</details>'
- en: The result is an array of three values. They are bounded between 0 and 1, and
    they always add up to 1, so they can be interpreted as the probabilities of a
    set of outcomes that are mutually exclusive and collectively exhaustive.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 结果是一个包含三个值的数组。它们介于0和1之间，并且它们总是加起来等于1，因此它们可以被解释为一组相互排斥且完全耗尽的结果的概率。
- en: 'Let’s see what the distributions of these values look like. I’ll draw 1000
    random vectors from this distribution, like this:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看这些值的分布是什么样子的。我将从这个分布中随机抽取1000个向量，就像这样：
- en: '[PRE35]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格内容
    隐藏代码单元格内容</summary>
- en: '[PRE36]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: '[PRE37]</details>'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE37]</details>'
- en: The result is an array with 1000 rows and three columns. I’ll compute the `Cdf`
    of the values in each column.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 结果是一个包含1000行和三列的数组。我将计算每列中值的`Cdf`。
- en: '[PRE38]'
  id: totrans-125
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: The result is a list of `Cdf` objects that represent the marginal distributions
    of the three variables. Here’s what they look like.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 结果是一个代表三个变量的边缘分布的`Cdf`对象列表。它们看起来是这样的。
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格源代码隐藏代码单元格源代码</summary>
- en: '[PRE39]</details> ![_images/38e3455314147946835c8800653dfd01a9f1c97c9b568a01c8e33c8802a29287.png](../Images/9936b94966fbbbda87abcfe0339c0257.png)'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE39]</details> ![_images/38e3455314147946835c8800653dfd01a9f1c97c9b568a01c8e33c8802a29287.png](../Images/9936b94966fbbbda87abcfe0339c0257.png)'
- en: Column 0, which corresponds to the lowest parameter, contains the lowest probabilities.
    Column 2, which corresponds to the highest parameter, contains the highest probabilities.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 第0列对应最低参数，包含最低概率。第2列对应最高参数，包含最高概率。
- en: 'As it turns out, these marginal distributions are beta distributions. The following
    function takes a sequence of parameters, `alpha`, and computes the marginal distribution
    of variable `i`:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 事实证明，这些边际分布是贝塔分布。以下函数接受参数序列`alpha`，并计算变量`i`的边缘分布：
- en: '[PRE40]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: We can use it to compute the marginal distribution for the three variables.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以用它来计算三个变量的边缘分布。
- en: '[PRE41]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: The following plot shows the CDF of these distributions as gray lines and compares
    them to the CDFs of the samples.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 下图显示了这些分布的CDF作为灰色线，并将它们与样本的CDF进行了比较。
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格源代码隐藏代码单元格源代码</summary>
- en: '[PRE42]</details> ![_images/d2b045b7f54a65ceb60914590d7732e667f5f95b187400fa17363aed09dfab01.png](../Images/f50fbf1c81705f94c9ff9b1e33a4d90c.png)'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE42]</details> ![_images/d2b045b7f54a65ceb60914590d7732e667f5f95b187400fa17363aed09dfab01.png](../Images/f50fbf1c81705f94c9ff9b1e33a4d90c)'
- en: This confirms that the marginals of the Dirichlet distribution are beta distributions.
    And that’s useful because the Dirichlet distribution is the conjugate prior for
    the multinomial likelihood function.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 这证实了狄利克雷分布的边缘分布是贝塔分布。这很有用，因为狄利克雷分布是多项式似然函数的共轭先验。
- en: If the prior distribution is Dirichlet with parameter vector `alpha` and the
    data is a vector of observations, `data`, the posterior distribution is Dirichlet
    with parameter vector `alpha + data`.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 如果先验分布是具有参数向量`alpha`的狄利克雷分布，数据是一组观测值`data`的向量，则后验分布是具有参数向量`alpha + data`的狄利克雷分布。
- en: As an exercise at the end of this chapter, you can use this method to solve
    the Lions and Tigers and Bears problem.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 作为本章结束时的练习，您可以使用这种方法来解决狮子、老虎和熊的问题。
- en: Summary
  id: totrans-140
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 总结
- en: After reading this chapter, if you feel like you’ve been tricked, I understand.
    It turns out that many of the problems in this book can be solved with just a
    few arithmetic operations. So why did we go to all the trouble of using grid algorithms?
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 阅读完本章后，如果你觉得自己被愚弄了，我理解。事实证明，这本书中的许多问题只需要进行一些算术运算就可以解决。那么为什么我们要费这么大劲使用网格算法呢？
- en: Sadly, there are only a few problems we can solve with conjugate priors; in
    fact, this chapter includes most of the ones that are useful in practice.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 遗憾的是，我们只能用共轭先验解决少数问题；事实上，本章包括了实践中大部分有用的问题。
- en: For the vast majority of problems, there is no conjugate prior and no shortcut
    to compute the posterior distribution. That’s why we need grid algorithms and
    the methods in the next two chapters, Approximate Bayesian Computation (ABC) and
    Markov chain Monte Carlo methods (MCMC).
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 对于绝大多数问题，没有共轭先验，也没有计算后验分布的捷径。这就是为什么我们需要网格算法和接下来两章中的方法，即近似贝叶斯计算（ABC）和马尔可夫链蒙特卡洛方法（MCMC）。
- en: Exercises
  id: totrans-144
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 练习
- en: '**Exercise:** In the second version of the World Cup problem, the data we use
    for the update is not the number of goals in a game, but the time until the first
    goal. So the probability of the data is given by the exponential distribution
    rather than the Poisson distribution.'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: '**练习：**在世界杯问题的第二个版本中，我们用于更新的数据不是一场比赛中的进球数，而是直到第一个进球的时间。因此，数据的概率由指数分布给出，而不是泊松分布。'
- en: But it turns out that the gamma distribution is *also* the conjugate prior of
    the exponential distribution, so there is a simple way to compute this update,
    too. The PDF of the exponential distribution is a function of \(t\) with \(\lambda\)
    as a parameter.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 但事实证明，伽玛分布也是指数分布的共轭先验，因此也有一种简单的方法来计算这个更新。指数分布的PDF是关于\(t\)的函数，其中\(\lambda\)是参数。
- en: \[\lambda e^{-\lambda t}\]
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: \[\lambda e^{-\lambda t}\]
- en: Multiply the PDF of the gamma prior by this likelihood, confirm that the result
    is an unnormalized gamma distribution, and see if you can derive its parameters.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 将伽玛先验的PDF乘以这个似然，确认结果是一个未归一化的伽玛分布，并看看你是否可以推导出它的参数。
- en: Write a few lines of code to update `prior_gamma` with the data from this version
    of the problem, which was a first goal after 11 minutes and a second goal after
    an additional 12 minutes.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 写几行代码来使用这个问题版本的数据更新`prior_gamma`，这是在11分钟后的第一个目标和额外12分钟后的第二个目标之后的第一个目标。
- en: Remember to express these quantities in units of games, which are approximately
    90 minutes.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 记得用大约90分钟的游戏单位来表示这些数量。
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格内容隐藏代码单元格内容</summary>
- en: '[PRE43]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE43]</details> <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格内容隐藏代码单元格内容</summary>'
- en: '[PRE44]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE44]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">显示代码单元格内容隐藏代码单元格内容</summary>'
- en: '[PRE45]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: '[PRE46]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE46]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">显示代码单元格内容隐藏代码单元格内容</summary>'
- en: '[PRE47]'
  id: totrans-156
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: '![_images/4b02d1d83de1cd604d399109a433c3edb273cfc7a8407045a8aade575d235c6e.png](../Images/4d92153053608fe4987f356fc8345b6d.png)</details>'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: '![_images/4b02d1d83de1cd604d399109a433c3edb273cfc7a8407045a8aade575d235c6e.png](../Images/4d92153053608fe4987f356fc8345b6d.png)</details>'
- en: '**Exercise:** For problems like the Euro problem where the likelihood function
    is binomial, we can do a Bayesian update with just a few arithmetic operations,
    but only if the prior is a beta distribution.'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '**练习：** 对于像欧元问题这样的似然函数是二项式的问题，我们可以通过一些算术运算进行贝叶斯更新，但前提是先验是一个贝塔分布。'
- en: If we want a uniform prior, we can use a beta distribution with `alpha=1` and
    `beta=1`. But what can we do if the prior distribution we want is not a beta distribution?
    For example, in <<_TrianglePrior>> we also solved the Euro problem with a triangle
    prior, which is not a beta distribution.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们想要一个均匀的先验分布，我们可以使用`alpha=1`和`beta=1`的贝塔分布。但是如果我们想要的先验分布不是贝塔分布怎么办？例如，在<<_TrianglePrior>>中，我们还用三角形先验解决了欧元问题，这不是一个贝塔分布。
- en: In these cases, we can often find a beta distribution that is a good-enough
    approximation for the prior we want. See if you can find a beta distribution that
    fits the triangle prior, then update it using `update_beta`.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 在这些情况下，我们通常可以找到一个贝塔分布，它是我们想要的先验的一个足够好的近似。看看你是否能找到一个适合三角形先验的贝塔分布，然后使用`update_beta`进行更新。
- en: Use `pmf_from_dist` to make a `Pmf` that approximates the posterior distribution
    and compare it to the posterior we just computed using a grid algorithm. How big
    is the largest difference between them?
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`pmf_from_dist`制作一个近似后验分布的`Pmf`，并将其与我们刚刚使用网格算法计算的后验进行比较。它们之间的最大差异有多大？
- en: Here’s the triangle prior again.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 这是三角形先验。
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格内容隐藏代码单元格内容</summary>
- en: '[PRE48]'
  id: totrans-164
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: '[PRE49]</details>'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE49]</details>'
- en: And here’s the update.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 这是更新。
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格内容隐藏代码单元格内容</summary>
- en: '[PRE50]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: '[PRE51]</details>'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE51]</details>'
- en: To get you started, here’s the beta distribution that we used as a uniform prior.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 为了帮助你入门，这是我们用作均匀先验的贝塔分布。
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格内容隐藏代码单元格内容</summary>
- en: '[PRE52]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: '[PRE53]</details>'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE53]</details>'
- en: And here’s what it looks like compared to the triangle prior.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 这是它与三角形先验的比较。
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格内容隐藏代码单元格内容</summary>
- en: '[PRE54]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: '![_images/8a092622087a81b63220299ed339ad33e748615fdf8b8c669f8a3a99a5c416f1.png](../Images/73af9d0e16a3a3a26f30c218b855c169.png)</details>'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: '![_images/8a092622087a81b63220299ed339ad33e748615fdf8b8c669f8a3a99a5c416f1.png](../Images/73af9d0e16a3a3a26f30c218b855c169.png)</details>'
- en: Now you take it from there.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 现在由你来继续。
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格内容隐藏代码单元格内容</summary>
- en: '[PRE55]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: '[PRE56]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE56]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">显示代码单元格内容隐藏代码单元格内容</summary>'
- en: '[PRE57]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE57]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">显示代码单元格内容隐藏代码单元格内容</summary>'
- en: '[PRE58]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: '![_images/c876c409c11dd54ba4da7d89608ab9129059f96d92b73aa846a81dcf77d3d82c.png](../Images/70a181595d707f471e4b328a30987f04.png)</details><details
    class="hide above-input"><summary aria-label="Toggle hidden content">Show code
    cell content Hide code cell content</summary>'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: '![_images/c876c409c11dd54ba4da7d89608ab9129059f96d92b73aa846a81dcf77d3d82c.png](../Images/70a181595d707f471e4b328a30987f04.png)</details><details
    class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格内容隐藏代码单元格内容</summary>'
- en: '[PRE59]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: '[PRE60]</details>'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE60]</details>'
- en: '**Exercise:** [3Blue1Brown](https://en.wikipedia.org/wiki/3Blue1Brown) is a
    YouTube channel about math; if you are not already aware of it, I recommend it
    highly. In [this video](https://www.youtube.com/watch?v=8idr1WZ1A7Q) the narrator
    presents this problem:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: '**练习：** [3Blue1Brown](https://en.wikipedia.org/wiki/3Blue1Brown) 是一个关于数学的YouTube频道；如果你还不知道它，我强烈推荐。在[这个视频](https://www.youtube.com/watch?v=8idr1WZ1A7Q)中，叙述者提出了这个问题：'
- en: You are buying a product online and you see three sellers offering the same
    product at the same price. One of them has a 100% positive rating, but with only
    10 reviews. Another has a 96% positive rating with 50 total reviews. And yet another
    has a 93% positive rating, but with 200 total reviews.
  id: totrans-188
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 你正在网上购买一个产品，看到有三个卖家以相同的价格提供相同的产品。其中一个卖家有100%的积极评价，但只有10条评论。另一个卖家有96%的积极评价，共有50条评论。还有一个卖家有93%的积极评价，但共有200条评论。
- en: ''
  id: totrans-189
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Which one should you buy from?
  id: totrans-190
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 你应该从哪个卖家购买？
- en: Let’s think about how to model this scenario. Suppose each seller has some unknown
    probability, `x`, of providing satisfactory service and getting a positive rating,
    and we want to choose the seller with the highest value of `x`.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们思考如何对这种情景建模。假设每个卖家都有一些未知的概率`x`，能够提供满意的服务并获得积极评价，我们想选择具有最高`x`值的卖家。
- en: This is not the only model for this scenario, and it is not necessarily the
    best. An alternative would be something like item response theory, where sellers
    have varying ability to provide satisfactory service and customers have varying
    difficulty of being satisfied.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 这不是这种情况的唯一模型，也不一定是最好的。另一种选择可能是项目反应理论，其中卖家有不同的能力提供满意的服务，顾客有不同的满意度难度。
- en: But the first model has the virtue of simplicity, so let’s see where it gets
    us.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 但第一个模型具有简单的优点，所以让我们看看它能带给我们什么。
- en: As a prior, I suggest a beta distribution with `alpha=8` and `beta=2`. What
    does this prior look like and what does it imply about sellers?
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 作为先验，我建议使用 `alpha=8`，`beta=2` 的贝塔分布。这个先验是什么样子的，它对卖家有什么暗示？
- en: Use the data to update the prior for the three sellers and plot the posterior
    distributions. Which seller has the highest posterior mean?
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用数据更新三个卖家的先验，并绘制后验分布。哪个卖家具有最高的后验均值？
- en: How confident should we be about our choice? That is, what is the probability
    that the seller with the highest posterior mean actually has the highest value
    of `x`?
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们对我们的选择应该有多大的信心？也就是说，具有最高后验均值的卖家实际上具有最高的 `x` 值的概率是多少？
- en: Consider a beta prior with `alpha=0.7` and `beta=0.5`. What does this prior
    look like and what does it imply about sellers?
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 考虑一个贝塔先验，其中 `alpha=0.7`，`beta=0.5`。这个先验是什么样子的，它对卖家有什么暗示？
- en: Run the analysis again with this prior and see what effect it has on the results.
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用这个先验再次运行分析，看看它对结果有什么影响。
- en: 'Note: When you evaluate the beta distribution, you should restrict the range
    of `xs` so it does not include 0 and 1\. When the parameters of the beta distribution
    are less than 1, the probability density goes to infinity at 0 and 1\. From a
    mathematical point of view, that’s not a problem; it is still a proper probability
    distribution. But from a computational point of view, it means we have to avoid
    evaluating the PDF at 0 and 1.'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：当你评估贝塔分布时，你应该限制 `xs` 的范围，使其不包括 0 和 1。当贝塔分布的参数小于 1 时，概率密度在 0 和 1 处趋于无穷大。从数学的角度来看，这并不是问题；它仍然是一个适当的概率分布。但从计算的角度来看，这意味着我们必须避免在
    0 和 1 处评估概率密度函数。
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格内容 隐藏代码单元格内容</summary>
- en: '[PRE61]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: '![_images/10f1e732645ad625d44851743d4fe343a94841acc5b05777fdb17545b3e088be.png](../Images/3467044fe4b8f6bbd9e4caaca9246e97.png)</details><details
    class="hide above-input"><summary aria-label="Toggle hidden content">Show code
    cell content Hide code cell content</summary>'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: '![_images/10f1e732645ad625d44851743d4fe343a94841acc5b05777fdb17545b3e088be.png](../Images/3467044fe4b8f6bbd9e4caaca9246e97.png)</details><details
    class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格内容 隐藏代码单元格内容</summary>'
- en: '[PRE62]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE62] </details> <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格内容
    隐藏代码单元格内容</summary>'
- en: '[PRE63]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE63] </details> <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格内容
    隐藏代码单元格内容</summary>'
- en: '[PRE64]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE64] </details> <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格内容
    隐藏代码单元格内容</summary>'
- en: '[PRE65]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: '![_images/287d7bc9e8018421486a23dfd8721014d0c702fff0d03d83edec1951ee90458a.png](../Images/b9e1eb89662d72d4365e5ef48b669c68.png)</details><details
    class="hide above-input"><summary aria-label="Toggle hidden content">Show code
    cell content Hide code cell content</summary>'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: '![_images/287d7bc9e8018421486a23dfd8721014d0c702fff0d03d83edec1951ee90458a.png](../Images/b9e1eb89662d72d4365e5ef48b669c68.png)</details><details
    class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格内容 隐藏代码单元格内容</summary>'
- en: '[PRE66]'
  id: totrans-208
  prefs: []
  type: TYPE_PRE
  zh: '[PRE66]'
- en: '[PRE67]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE67] </details> <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格内容
    隐藏代码单元格内容</summary>'
- en: '[PRE68]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE68] </details> <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格内容
    隐藏代码单元格内容</summary>'
- en: '[PRE69]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE69]'
- en: '|  | probs |'
  id: totrans-212
  prefs: []
  type: TYPE_TB
  zh: '|  | 概率 |'
- en: '| --- | --- |'
  id: totrans-213
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| 0 | 0.2948 |'
  id: totrans-214
  prefs: []
  type: TYPE_TB
  zh: '| 0 | 0.2948 |'
- en: '| 1 | 0.4750 |'
  id: totrans-215
  prefs: []
  type: TYPE_TB
  zh: '| 1 | 0.4750 |'
- en: '| 2 | 0.2302 |</details>'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: '| 2 | 0.2302 |</details>'
- en: '**Exercise:** Use a Dirichlet prior with parameter vector `alpha = [1, 1, 1]`
    to solve the Lions and Tigers and Bears problem:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: '**练习：** 使用参数向量 `alpha = [1, 1, 1]` 的狄利克雷先验来解决狮子、老虎和熊的问题：'
- en: Suppose we visit a wild animal preserve where we know that the only animals
    are lions and tigers and bears, but we don’t know how many of each there are.
  id: totrans-218
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 假设我们参观一个野生动物保护区，我们知道那里的动物只有狮子、老虎和熊，但我们不知道每种动物的数量。
- en: ''
  id: totrans-219
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: During the tour, we see three lions, two tigers, and one bear. Assuming that
    every animal had an equal chance to appear in our sample, estimate the prevalence
    of each species.
  id: totrans-220
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 在游览期间，我们看到三只狮子，两只老虎和一只熊。假设每种动物在我们的样本中出现的机会是相等的，估计每种动物的普遍性。
- en: ''
  id: totrans-221
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: What is the probability that the next animal we see is a bear?
  id: totrans-222
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 下一个我们看到的动物是熊的概率是多少？
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格内容 隐藏代码单元格内容</summary>
- en: '[PRE70]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE70] </details> <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格内容
    隐藏代码单元格内容</summary>'
- en: '[PRE71]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE71] </details> <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格内容
    隐藏代码单元格内容</summary>'
- en: '[PRE72]'
  id: totrans-226
  prefs: []
  type: TYPE_PRE
  zh: '[PRE72]'
- en: '[PRE73]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE73]</details> <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格内容
    隐藏代码单元格内容</summary>'
- en: '[PRE74]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE74]</details> <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格内容
    隐藏代码单元格内容</summary>'
- en: '[PRE75]'
  id: totrans-229
  prefs: []
  type: TYPE_PRE
  zh: '[PRE75]'
- en: '|  | prob |'
  id: totrans-230
  prefs: []
  type: TYPE_TB
  zh: '|  | 概率 |'
- en: '| --- | --- |'
  id: totrans-231
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| lion | 0.444444 |'
  id: totrans-232
  prefs: []
  type: TYPE_TB
  zh: '| 狮子 | 0.444444 |'
- en: '| tiger | 0.333333 |'
  id: totrans-233
  prefs: []
  type: TYPE_TB
  zh: '| 老虎 | 0.333333 |'
- en: '| bear | 0.222222 |</details>'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: '| 熊 | 0.222222 |</details>'

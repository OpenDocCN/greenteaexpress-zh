- en: The Red Line Problem
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 红线问题
- en: 原文：[https://allendowney.github.io/ThinkBayes2/redline.html](https://allendowney.github.io/ThinkBayes2/redline.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://allendowney.github.io/ThinkBayes2/redline.html](https://allendowney.github.io/ThinkBayes2/redline.html)
- en: The Red Line is a subway that connects Cambridge and Boston, Massachusetts.
    When I was working in Cambridge I took the Red Line from Kendall Square to South
    Station and caught the commuter rail to Needham. During rush hour Red Line trains
    run every 7–8 minutes, on average.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 红线是马萨诸塞州剑桥和波士顿之间的地铁。当我在剑桥工作时，我从肯德尔广场乘坐红线到南站，然后搭乘通勤列车到尼德姆。在高峰时间，红线列车平均每7-8分钟运行一次。
- en: When I arrived at the subway stop, I could estimate the time until the next
    train based on the number of passengers on the platform. If there were only a
    few people, I inferred that I just missed a train and expected to wait about 7
    minutes. If there were more passengers, I expected the train to arrive sooner.
    But if there were a large number of passengers, I suspected that trains were not
    running on schedule, so I would leave the subway stop and get a taxi.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 当我到达地铁站时，我可以根据站台上的乘客数量估计下一班火车的时间。如果只有几个人，我推断我刚错过了一班火车，预计要等大约7分钟。如果有更多的乘客，我预计火车会更快到达。但如果有很多乘客，我怀疑火车没有按时运行，所以我会离开地铁站，打车。
- en: While I was waiting for trains, I thought about how Bayesian estimation could
    help predict my wait time and decide when I should give up and take a taxi. This
    chapter presents the analysis I came up with.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 当我在等火车的时候，我想到了贝叶斯估计如何帮助预测我的等待时间，并决定何时放弃，乘坐出租车。本章介绍了我想出的分析。
- en: This example is based on a project by Brendan Ritter and Kai Austin, who took
    a class with me at Olin College.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 这个例子是基于布兰登·里特和凯·奥斯汀的一个项目，他们在奥林学院和我一起上课。
- en: '[Click here to run this notebook on Colab](https://colab.research.google.com/github/AllenDowney/ThinkBayes2/blob/master/notebooks/redline.ipynb)'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '[单击此处在Colab上运行此笔记本](https://colab.research.google.com/github/AllenDowney/ThinkBayes2/blob/master/notebooks/redline.ipynb)'
- en: Before we get to the analysis, we have to make some modeling decisions. First,
    I will treat passenger arrivals as a Poisson process, which means I assume that
    passengers are equally likely to arrive at any time, and that they arrive at a
    rate, λ, measured in passengers per minute. Since I observe passengers during
    a short period of time, and at the same time every day, I assume that λ is constant.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们进行分析之前，我们必须做出一些建模决策。首先，我将把乘客到达视为泊松过程，这意味着我假设乘客在任何时间到达的可能性都是相等的，并且以每分钟到达的速率λ来到达。由于我在短时间内观察到乘客，并且每天都在同一时间观察到乘客，我假设λ是恒定的。
- en: On the other hand, the arrival process for trains is not Poisson. Trains to
    Boston are supposed to leave from the end of the line (Alewife station) every
    7–8 minutes during peak times, but by the time they get to Kendall Square, the
    time between trains varies between 3 and 12 minutes.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 另一方面，火车的到达过程不是泊松过程。到波士顿的火车应该在高峰时段每7-8分钟从终点站（阿尔维夫站）出发，但是当它们到达肯德尔广场时，列车之间的时间在3到12分钟之间变化。
- en: To gather data on the time between trains, I wrote a script that downloads real-time
    data from the [MBTA](http://www.mbta.com/rider_tools/developers/), selects south-bound
    trains arriving at Kendall square, and records their arrival times in a database.
    I ran the script from 4 pm to 6 pm every weekday for 5 days, and recorded about
    15 arrivals per day. Then I computed the time between consecutive arrivals. Here
    are the gap times I recorded, in seconds.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 为了收集有关列车之间的时间的数据，我编写了一个脚本，从[MBTA](http://www.mbta.com/rider_tools/developers/)下载实时数据，选择到达肯德尔广场的南行列车，并记录它们的到达时间在数据库中。我每个工作日下午4点到6点运行脚本5天，并记录每天约15次到达。然后我计算了连续到达之间的时间间隔。这是我记录的间隔时间，以秒为单位。
- en: '[PRE0]'
  id: totrans-10
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: I’ll convert them to minutes and use `kde_from_sample` to estimate the distribution.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 我将把它们转换成分钟，并使用`kde_from_sample`来估计分布。
- en: '[PRE1]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '[PRE2]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Here’s what it looks like.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是它的样子。
- en: '[PRE3]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '![_images/f8de2d9ea7de2af767afcae042feb625b0d0d7fd7fae5a11f6e19d5b321734de.png](../Images/7e5c60a70c0bba8a0b8e1436228eb7b6.png)'
  id: totrans-16
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/7e5c60a70c0bba8a0b8e1436228eb7b6.png)'
- en: The Update
  id: totrans-17
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更新
- en: At this point we have an estimate for the distribution of time between trains.
    Now let’s suppose I arrive at the station and see 10 passengers on the platform.
    What distribution of wait times should I expect?
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一点上，我们已经对列车之间的时间分布有了估计。现在假设我到达车站，看到站台上有10名乘客。我应该期望什么等待时间的分布？
- en: We’ll answer this question in two steps.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将分两步回答这个问题。
- en: First, we’ll derive the distribution of gap times as observed by a random arrival
    (me).
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 首先，我们将推导出作为随机到达（我）观察到的间隔时间的分布。
- en: Then we’ll derive the distribution of wait times, conditioned on the number
    of passengers.
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 然后我们将推导出等待时间的分布，条件是乘客的数量。
- en: When I arrive at the station, I am more likely to arrive during a long gap than
    a short one. In fact, the probability that I arrive during any interval is proportional
    to its duration.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 当我到达车站时，我更有可能在较长的间隔期间到达，而不是在较短的间隔期间到达。实际上，我在任何间隔期间到达的概率与其持续时间成正比。
- en: 'If we think of `pmf_z` as the prior distribution of gap time, we can do a Bayesian
    update to compute the posterior. The likelihood of my arrival during each gap
    is the duration of the gap:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们把`pmf_z`看作是间隔时间的先验分布，我们可以进行贝叶斯更新来计算后验分布。我在每个间隔期间到达的可能性是间隔的持续时间：
- en: '[PRE4]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: So here’s the first update.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 所以这是第一个更新。
- en: '[PRE5]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '[PRE6]'
  id: totrans-27
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Here’s what the posterior distribution looks like.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是后验分布的样子。
- en: '[PRE7]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![_images/c8f070e98dd2ff4564a00771e7d566b5ec33b51f101ed7bb1ff7fb5ee3ba3b56.png](../Images/f151fe5e310d26189b4c0ccf0015adea.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/f151fe5e310d26189b4c0ccf0015adea.png)'
- en: Because I am more likely to arrive during a longer gap, the distribution is
    shifted to the right. The prior mean is about 7.8 minutes; the posterior mean
    is about 8.9 minutes.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 因为我更有可能在较长的间隔期间到达，所以分布向右移。先验均值约为7.8分钟；后验均值约为8.9分钟。
- en: '[PRE8]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '[PRE9]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: This shift is an example of the “inspection paradox”, which [I wrote an article
    about](https://towardsdatascience.com/the-inspection-paradox-is-everywhere-2ef1c2e9d709).
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
- en: As an aside, the Red Line schedule reports that trains run every 9 minutes during
    peak times. This is close to the posterior mean, but higher than the prior mean.
    I exchanged email with a representative of the MBTA, who confirmed that the reported
    time between trains is deliberately conservative in order to account for variability.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
- en: Elapsed time
  id: totrans-36
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Elapsed time, which I call `x`, is the time between the arrival of the previous
    train and the arrival of a passenger. Wait time, which I call `y`, is the time
    between the arrival of a passenger and the next arrival of a train. I chose this
    notation so that
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Given the distribution of `z`, we can compute the distribution of `x`. I’ll
    start with a simple case and then generalize. Suppose the gap between trains is
    either 5 or 10 minutes with equal probability.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
- en: If we arrive at a random time, we arrive during a 5 minute gap with probability
    1/3, or a 10 minute gap with probability 2/3.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
- en: If we arrive during a 5 minute gap, `x` is uniform from 0 to 5 minutes. If we
    arrive during a 10 minute gap, `x` is uniform from 0 to 10. So the distribution
    of wait times is a weighted mixture of two uniform distributions.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
- en: More generally, if we have the posterior distribution of `z`, we can compute
    the distribution of `x` by making a mixture of uniform distributions. We’ll use
    the following function to make the uniform distributions.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '`make_elapsed_dist` takes a hypothetical gap and an array of possible times.
    It selects the elapsed times less than or equal to `gap` and puts them into a
    `Pmf` that represents a uniform distribution.'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
- en: I’ll use this function to make a sequence of `Pmf` objects, one for each gap
    in `posterior_z`.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Here’s an example that represents a uniform distribution from 0 to 0.6 minutes.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '|  | probs |'
  id: totrans-49
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-50
  prefs: []
  type: TYPE_TB
- en: '| 0.0 | 0.25 |'
  id: totrans-51
  prefs: []
  type: TYPE_TB
- en: '| 0.2 | 0.25 |'
  id: totrans-52
  prefs: []
  type: TYPE_TB
- en: '| 0.4 | 0.25 |'
  id: totrans-53
  prefs: []
  type: TYPE_TB
- en: '| 0.6 | 0.25 |'
  id: totrans-54
  prefs: []
  type: TYPE_TB
- en: The last element of the sequence is uniform from 0 to 20 minutes.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '![_images/e04c1eca3ff2aea714e04a33a17b2de9c6cc50b1c57b7713bc9cae27a7752c73.png](../Images/5cd0ae13b62935fcd0aa0d8aab31d774.png)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
- en: Now we can use `make_mixture` to make a weighted mixture of uniform distributions,
    where the weights are the probabilities from `posterior_z`.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '[PRE16]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '![_images/6dea62010873c6070d43c669b7d6fed2488b72f85a7a92175e24eae25cedba65.png](../Images/b5912e612f0d114e052c5984a1af004b.png)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
- en: '[PRE17]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '[PRE18]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: The mean elapsed time is 4.4 minutes, half the posterior mean of `z`. And that
    makes sense, since we expect to arrive in the middle of the gap, on average.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
- en: Counting passengers
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Now let’s take into account the number of passengers waiting on the platform.
    Let’s assume that passengers are equally likely to arrive at any time, and that
    they arrive at a rate, `λ`, that is known to be 2 passengers per minute.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
- en: Under those assumptions, the number of passengers who arrive in `x` minutes
    follows a Poisson distribution with parameter `λ x` So we can use the SciPy function
    `poisson` to compute the likelihood of 10 passengers for each possible value of
    `x`.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: With this likelihood, we can compute the posterior distribution of `x`.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '[PRE21]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Here’s what it looks like:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '![_images/32a1f7d633afb2a26c83c036ec21abe5835f2647577f4f38059cc02c3083bbe9.png](../Images/a724e2ebba97e3d3b3149c940de6d5b5.png)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
- en: Based on the number of passengers, we think it has been about 5 minutes since
    the last train.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE23]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '[PRE24]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Wait time
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Now how long do we think it will be until the next train? Based on what we know
    so far, the distribution of `z` is `posterior_z`, and the distribution of `x`
    is `posterior_x`. Remember that we defined
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE25]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: If we know `x` and `z`, we can compute
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE26]'
  id: totrans-82
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: So we can use `sub_dist` to compute the distribution of `y`.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE27]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Well, almost. That distribution contains some negative values, which are impossible.
    But we can remove them and renormalize, like this:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE28]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '[PRE29]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Based on the information so far, here are the distributions for `x`, `y`, and
    `z`, shown as CDFs.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE30]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '![_images/61d9287b6df210c1961fdd80866bb33aed5bd0f21854fe0ae10d4fbf5e6cda7d.png](../Images/75e81c84847b0f9a0cbfd30dae478be9.png)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
- en: Because of rounding errors, `posterior_y` contains quantities that are not in
    `posterior_x` and `posterior_z`; that’s why I plotted it as a CDF, and why it
    appears jaggy.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
- en: Decision analysis
  id: totrans-92
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'At this point we can use the number of passengers on the platform to predict
    the distribution of wait times. Now let’s get to the second part of the question:
    when should I stop waiting for the train and go catch a taxi?'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
- en: Remember that in the original scenario, I am trying to get to South Station
    to catch the commuter rail. Suppose I leave the office with enough time that I
    can wait 15 minutes and still make my connection at South Station.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
- en: In that case I would like to know the probability that `y` exceeds 15 minutes
    as a function of `num_passengers`. To answer that question, we can run the analysis
    from the previous section with range of `num_passengers`.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
- en: But there’s a problem. The analysis is sensitive to the frequency of long delays,
    and because long delays are rare, it is hard to estimate their frequency.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
- en: I only have data from one week, and the longest delay I observed was 15 minutes.
    So I can’t estimate the frequency of longer delays accurately.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
- en: However, I can use previous observations to make at least a coarse estimate.
    When I commuted by Red Line for a year, I saw three long delays caused by a signaling
    problem, a power outage, and “police activity” at another stop. So I estimate
    that there are about 3 major delays per year.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
- en: But remember that my observations are biased. I am more likely to observe long
    delays because they affect a large number of passengers. So we should treat my
    observations as a sample of `posterior_z` rather than `pmf_z`.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
- en: Here’s how we can augment the observed distribution of gap times with some assumptions
    about long delays. From `posterior_z`, I’ll draw a sample of 260 values (roughly
    the number of work days in a year). Then I’ll add in delays of 30, 40, and 50
    minutes (the number of long delays I observed in a year).
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE31]'
  id: totrans-101
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: I’ll use this augmented sample to make a new estimate for the posterior distribution
    of `z`.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE32]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: Here’s what it looks like.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE33]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: '![_images/7bfbd95ae9bd4887c57bc32400c1dec1dbeb8652fa9241dc818eacb979846646.png](../Images/f95937bcdf0834cd93a8fc34d62d2008.png)'
  id: totrans-106
  prefs: []
  type: TYPE_IMG
- en: Now let’s take the analysis from the previous sections and wrap it in a function.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE34]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: Given the number of passengers when we arrive at the station, it computes the
    posterior distribution of `y`. As an example, here’s the distribution of wait
    time if we see 10 passengers.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE35]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: We can use it to compute the mean wait time and the probability of waiting more
    than 15 minutes.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE36]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: '[PRE37]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: '[PRE38]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: '[PRE39]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: If we see 10 passengers, we expect to wait a little less than 5 minutes, and
    the chance of waiting more than 15 minutes is about 1%.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
- en: Let’s see what happens if we sweep through a range of values for `num_passengers`.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE40]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: Here’s the mean wait as a function of the number of passengers.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE41]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: '[PRE42]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: '![_images/de8465ec97e738535f8ac65691bea6648336280ca606ad9c716453477a6eb069.png](../Images/5e37984f60418e47375174ccc8603cdf.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
- en: If there are no passengers on the platform when I arrive, I infer that I just
    missed a train; in that case, the expected wait time is the mean of `augmented_posterior_z`.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
- en: The more passengers I see, the longer I think it has been since the last train,
    and the more likely a train arrives soon.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
- en: But only up to a point. If there are more than 30 passengers on the platform,
    that suggests that there is a long delay, and the expected wait time starts to
    increase.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
- en: Now here’s the probability that wait time exceeds 15 minutes.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE43]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: '[PRE44]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: '![_images/a87493d6a5550a6e781319f383c1cbe9de96056c8d7a72a31c5b2d216b9adac1.png](../Images/92079aa07aadc5383a5fa67cef4c049b.png)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
- en: When the number of passengers is less than 20, we infer that the system is operating
    normally, so the probability of a long delay is small. If there are 30 passengers,
    we suspect that something is wrong and expect longer delays.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
- en: If we are willing to accept a 5% chance of missing the connection at South Station,
    we should stay and wait as long as there are fewer than 30 passengers, and take
    a taxi if there are more.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们愿意接受在南站错过连接的概率为5%，我们应该等待，直到乘客少于30人，如果超过这个数量就应该乘坐出租车。
- en: Or, to take this analysis one step further, we could quantify the cost of missing
    the connection and the cost of taking a taxi, then choose the threshold that minimizes
    expected cost.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，为了进一步分析，我们可以量化错过连接的成本和乘坐出租车的成本，然后选择最小化预期成本的阈值。
- en: This analysis is based on the assumption that the arrival rate, `lam`, is known.
    If it is not known precisely, but is estimated from data, we could represent our
    uncertainty about `lam` with a distribution, compute the distribution of `y` for
    each value of `lam`, and make a mixture to represent the distribution of `y`.
    I did that in the version of this problem in the first edition of *Think Bayes*;
    I left it out here because it is not the focus of the problem.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 这种分析是基于到达率“lam”已知的假设。如果它不是精确已知的，而是从数据中估计出来的，我们可以用分布表示对“lam”的不确定性，计算每个“lam”值的“y”的分布，并进行混合以表示“y”的分布。我在《Bayes思维》第一版中的这个问题的版本中做过这样的处理；我在这里没有提到，因为这不是问题的重点。

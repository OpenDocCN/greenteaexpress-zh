- en: Poisson Processes
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://allendowney.github.io/ThinkBayes2/chap08.html](https://allendowney.github.io/ThinkBayes2/chap08.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: This chapter introduces the [Poisson process](https://en.wikipedia.org/wiki/Poisson_point_process),
    which is a model used to describe events that occur at random intervals. As an
    example of a Poisson process, we’ll model goal-scoring in soccer, which is American
    English for the game everyone else calls “football”. We’ll use goals scored in
    a game to estimate the parameter of a Poisson process; then we’ll use the posterior
    distribution to make predictions.
  prefs: []
  type: TYPE_NORMAL
- en: And we’ll solve The World Cup Problem.
  prefs: []
  type: TYPE_NORMAL
- en: The World Cup Problem
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In the 2018 FIFA World Cup final, France defeated Croatia 4 goals to 2\. Based
    on this outcome:'
  prefs: []
  type: TYPE_NORMAL
- en: How confident should we be that France is the better team?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If the same teams played again, what is the chance France would win again?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: To answer these questions, we have to make some modeling decisions.
  prefs: []
  type: TYPE_NORMAL
- en: First, I’ll assume that for any team against another team there is some unknown
    goal-scoring rate, measured in goals per game, which I’ll denote with the Python
    variable `lam` or the Greek letter \(\lambda\), pronounced “lambda”.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Second, I’ll assume that a goal is equally likely during any minute of a game.
    So, in a 90 minute game, the probability of scoring during any minute is \(\lambda/90\).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Third, I’ll assume that a team never scores twice during the same minute.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Of course, none of these assumptions is completely true in the real world, but
    I think they are reasonable simplifications. As George Box said, “All models are
    wrong; some are useful.” ([https://en.wikipedia.org/wiki/All_models_are_wrong](https://en.wikipedia.org/wiki/All_models_are_wrong)).
  prefs: []
  type: TYPE_NORMAL
- en: In this case, the model is useful because if these assumptions are true, at
    least roughly, the number of goals scored in a game follows a Poisson distribution,
    at least roughly.
  prefs: []
  type: TYPE_NORMAL
- en: The Poisson Distribution
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: If the number of goals scored in a game follows a [Poisson distribution](https://en.wikipedia.org/wiki/Poisson_distribution)
    with a goal-scoring rate, \(\lambda\), the probability of scoring \(k\) goals
    is
  prefs: []
  type: TYPE_NORMAL
- en: \[\lambda^k \exp(-\lambda) ~/~ k!\]
  prefs: []
  type: TYPE_NORMAL
- en: for any non-negative value of \(k\).
  prefs: []
  type: TYPE_NORMAL
- en: 'SciPy provides a `poisson` object that represents a Poisson distribution. We
    can create one with \(\lambda=1.4\) like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: The result is an object that represents a “frozen” random variable and provides
    `pmf`, which evaluates the probability mass function of the Poisson distribution.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: This result implies that if the average goal-scoring rate is 1.4 goals per game,
    the probability of scoring 4 goals in a game is about 4%.
  prefs: []
  type: TYPE_NORMAL
- en: We’ll use the following function to make a `Pmf` that represents a Poisson distribution.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '`make_poisson_pmf` takes as parameters the goal-scoring rate, `lam`, and an
    array of quantities, `qs`, where it should evaluate the Poisson PMF. It returns
    a `Pmf` object.'
  prefs: []
  type: TYPE_NORMAL
- en: For example, here’s the distribution of goals scored for `lam=1.4`, computed
    for values of `k` from 0 to 9.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: And here’s what it looks like.
  prefs: []
  type: TYPE_NORMAL
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell source Hide code cell source</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]</details> ![_images/58c54aa34d3731e8b80f04a10b301b1ece4e10316ef4a35fd1a70b4332219d71.png](../Images/5302f3f1e12bf32d1b9c9773338d78bd.png)'
  prefs: []
  type: TYPE_NORMAL
- en: The most likely outcomes are 0, 1, and 2; higher values are possible but increasingly
    unlikely. Values above 7 are negligible. This distribution shows that if we know
    the goal scoring rate, we can predict the number of goals.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now let’s turn it around: given a number of goals, what can we say about the
    goal-scoring rate?'
  prefs: []
  type: TYPE_NORMAL
- en: To answer that, we need to think about the prior distribution of `lam`, which
    represents the range of possible values and their probabilities before we see
    the score.
  prefs: []
  type: TYPE_NORMAL
- en: The Gamma Distribution
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: If you have ever seen a soccer game, you have some information about `lam`.
    In most games, teams score a few goals each. In rare cases, a team might score
    more than 5 goals, but they almost never score more than 10.
  prefs: []
  type: TYPE_NORMAL
- en: Using [data from previous World Cups](https://www.statista.com/statistics/269031/goals-scored-per-game-at-the-fifa-world-cup-since-1930/),
    I estimate that each team scores about 1.4 goals per game, on average. So I’ll
    set the mean of `lam` to be 1.4.
  prefs: []
  type: TYPE_NORMAL
- en: For a good team against a bad one, we expect `lam` to be higher; for a bad team
    against a good one, we expect it to be lower.
  prefs: []
  type: TYPE_NORMAL
- en: 'To model the distribution of goal-scoring rates, I’ll use a [gamma distribution](https://en.wikipedia.org/wiki/Gamma_distribution),
    which I chose because:'
  prefs: []
  type: TYPE_NORMAL
- en: The goal scoring rate is continuous and non-negative, and the gamma distribution
    is appropriate for this kind of quantity.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The gamma distribution has only one parameter, `alpha`, which is the mean. So
    it’s easy to construct a gamma distribution with the mean we want.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: As we’ll see, the shape of the gamma distribution is a reasonable choice, given
    what we know about soccer.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: And there’s one more reason, which I will reveal in <<_ConjugatePriors>>.
  prefs: []
  type: TYPE_NORMAL
- en: SciPy provides `gamma`, which creates an object that represents a gamma distribution.
    And the `gamma` object provides provides `pdf`, which evaluates the **probability
    density function** (PDF) of the gamma distribution.
  prefs: []
  type: TYPE_NORMAL
- en: Here’s how we use it.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: The parameter, `alpha`, is the mean of the distribution. The `qs` are possible
    values of `lam` between 0 and 10. The `ps` are **probability densities**, which
    we can think of as unnormalized probabilities.
  prefs: []
  type: TYPE_NORMAL
- en: 'To normalize them, we can put them in a `Pmf` and call `normalize`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: The result is a discrete approximation of a gamma distribution. Here’s what
    it looks like.
  prefs: []
  type: TYPE_NORMAL
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell source Hide code cell source</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]</details> ![_images/7ba78434be5f44d022795ae6c9f5d4277050e2da9534b44be608bda840475700.png](../Images/02390b3b82770114a9b2194393796dc3.png)'
  prefs: []
  type: TYPE_NORMAL
- en: 'This distribution represents our prior knowledge about goal scoring: `lam`
    is usually less than 2, occasionally as high as 6, and seldom higher than that.'
  prefs: []
  type: TYPE_NORMAL
- en: And we can confirm that the mean is about 1.4.
  prefs: []
  type: TYPE_NORMAL
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE13]</details>'
  prefs: []
  type: TYPE_NORMAL
- en: As usual, reasonable people could disagree about the details of the prior, but
    this is good enough to get started. Let’s do an update.
  prefs: []
  type: TYPE_NORMAL
- en: The Update
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Suppose you are given the goal-scoring rate, \(\lambda\), and asked to compute
    the probability of scoring a number of goals, \(k\). That is precisely the question
    we answered by computing the Poisson PMF.
  prefs: []
  type: TYPE_NORMAL
- en: 'For example, if \(\lambda\) is 1.4, the probability of scoring 4 goals in a
    game is:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: 'Now suppose we are have an array of possible values for \(\lambda\); we can
    compute the likelihood of the data for each hypothetical value of `lam`, like
    this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: And that’s all we need to do the update. To get the posterior distribution,
    we multiply the prior by the likelihoods we just computed and normalize the result.
  prefs: []
  type: TYPE_NORMAL
- en: The following function encapsulates these steps.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: The first parameter is the prior; the second is the number of goals.
  prefs: []
  type: TYPE_NORMAL
- en: In the example, France scored 4 goals, so I’ll make a copy of the prior and
    update it with the data.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: Here’s what the posterior distribution looks like, along with the prior.
  prefs: []
  type: TYPE_NORMAL
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]</details> ![_images/8a3342b969ad573b94b1b8e696c887e4f7ee6b38a3b746430e6b92396d756742.png](../Images/882f5262ce4230869ad254016188d3d1.png)'
  prefs: []
  type: TYPE_NORMAL
- en: The data, `k=4`, makes us think higher values of `lam` are more likely and lower
    values are less likely. So the posterior distribution is shifted to the right.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s do the same for Croatia:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: And here are the results.
  prefs: []
  type: TYPE_NORMAL
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]</details> ![_images/d5a935a0a5ac15c7cef65b49f17499e8f84f352a4439e1461a9dd40ae0c830de.png](../Images/656cc186025415b771822c80241a93e4.png)'
  prefs: []
  type: TYPE_NORMAL
- en: Here are the posterior means for these distributions.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE23]'
  prefs: []
  type: TYPE_PRE
- en: The mean of the prior distribution is about 1.4. After Croatia scores 2 goals,
    their posterior mean is 1.7, which is near the midpoint of the prior and the data.
    Likewise after France scores 4 goals, their posterior mean is 2.7.
  prefs: []
  type: TYPE_NORMAL
- en: 'These results are typical of a Bayesian update: the location of the posterior
    distribution is a compromise between the prior and the data.'
  prefs: []
  type: TYPE_NORMAL
- en: Probability of Superiority
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Now that we have a posterior distribution for each team, we can answer the
    first question: How confident should we be that France is the better team?'
  prefs: []
  type: TYPE_NORMAL
- en: In the model, “better” means having a higher goal-scoring rate against the opponent.
    We can use the posterior distributions to compute the probability that a random
    value drawn from France’s distribution exceeds a value drawn from Croatia’s.
  prefs: []
  type: TYPE_NORMAL
- en: One way to do that is to enumerate all pairs of values from the two distributions,
    adding up the total probability that one value exceeds the other.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE24]'
  prefs: []
  type: TYPE_PRE
- en: 'This is similar to the method we use in <<_Addends>> to compute the distribution
    of a sum. Here’s how we use it:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE25]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE26]'
  prefs: []
  type: TYPE_PRE
- en: '`Pmf` provides a function that does the same thing.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE27]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE28]'
  prefs: []
  type: TYPE_PRE
- en: The results are slightly different because `Pmf.prob_gt` uses array operators
    rather than `for` loops.
  prefs: []
  type: TYPE_NORMAL
- en: Either way, the result is close to 75%. So, on the basis of one game, we have
    moderate confidence that France is actually the better team.
  prefs: []
  type: TYPE_NORMAL
- en: Of course, we should remember that this result is based on the assumption that
    the goal-scoring rate is constant. In reality, if a team is down by one goal,
    they might play more aggressively toward the end of the game, making them more
    likely to score, but also more likely to give up an additional goal.
  prefs: []
  type: TYPE_NORMAL
- en: As always, the results are only as good as the model.
  prefs: []
  type: TYPE_NORMAL
- en: Predicting the Rematch
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Now we can take on the second question: If the same teams played again, what
    is the chance Croatia would win? To answer this question, we’ll generate the “posterior
    predictive distribution”, which is the number of goals we expect a team to score.'
  prefs: []
  type: TYPE_NORMAL
- en: If we knew the goal scoring rate, `lam`, the distribution of goals would be
    a Poisson distribution with parameter `lam`. Since we don’t know `lam`, the distribution
    of goals is a mixture of a Poisson distributions with different values of `lam`.
  prefs: []
  type: TYPE_NORMAL
- en: First I’ll generate a sequence of `Pmf` objects, one for each value of `lam`.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE29]'
  prefs: []
  type: TYPE_PRE
- en: The following figure shows what these distributions look like for a few values
    of `lam`.
  prefs: []
  type: TYPE_NORMAL
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE30]</details> ![_images/62062c40c6a4a2831a237ab2924b29f91d3f6e61a7de23f3dc1237010380f9dd.png](../Images/fa119384238cf3adbcebd721047f6094.png)'
  prefs: []
  type: TYPE_NORMAL
- en: The predictive distribution is a mixture of these `Pmf` objects, weighted with
    the posterior probabilities. We can use `make_mixture` from <<_GeneralMixtures>>
    to compute this mixture.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE31]'
  prefs: []
  type: TYPE_PRE
- en: Here’s the predictive distribution for the number of goals France would score
    in a rematch.
  prefs: []
  type: TYPE_NORMAL
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE32]</details> ![_images/59075d25fad64df15f9e94a861a4486a16b91f6bad681d050dc3290afca3698d.png](../Images/a0ea95a1903ab36205deca76851c6d7a.png)'
  prefs: []
  type: TYPE_NORMAL
- en: 'This distribution represents two sources of uncertainty: we don’t know the
    actual value of `lam`, and even if we did, we would not know the number of goals
    in the next game.'
  prefs: []
  type: TYPE_NORMAL
- en: Here’s the predictive distribution for Croatia.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE33]'
  prefs: []
  type: TYPE_PRE
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE34]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/3c5c1e25e759daa7d773f22210dbfb08b6f53081a393466e75c90808850d29c0.png](../Images/99e85c8bf46cc101de4790585f805568.png)</details>'
  prefs: []
  type: TYPE_NORMAL
- en: We can use these distributions to compute the probability that France wins,
    loses, or ties the rematch.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE35]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE36]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE37]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE38]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE39]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE40]'
  prefs: []
  type: TYPE_PRE
- en: Assuming that France wins half of the ties, their chance of winning the rematch
    is about 65%.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE41]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE42]'
  prefs: []
  type: TYPE_PRE
- en: This is a bit lower than their probability of superiority, which is 75%. And
    that makes sense, because we are less certain about the outcome of a single game
    than we are about the goal-scoring rates. Even if France is the better team, they
    might lose the game.
  prefs: []
  type: TYPE_NORMAL
- en: The Exponential Distribution
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'As an exercise at the end of this notebook, you’ll have a chance to work on
    the following variation on the World Cup Problem:'
  prefs: []
  type: TYPE_NORMAL
- en: In the 2014 FIFA World Cup, Germany played Brazil in a semifinal match. Germany
    scored after 11 minutes and again at the 23 minute mark. At that point in the
    match, how many goals would you expect Germany to score after 90 minutes? What
    was the probability that they would score 5 more goals (as, in fact, they did)?
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: In this version, notice that the data is not the number of goals in a fixed
    period of time, but the time between goals.
  prefs: []
  type: TYPE_NORMAL
- en: To compute the likelihood of data like this, we can take advantage of the theory
    of Poisson processes again. If each team has a constant goal-scoring rate, we
    expect the time between goals to follow an [exponential distribution](https://en.wikipedia.org/wiki/Exponential_distribution).
  prefs: []
  type: TYPE_NORMAL
- en: 'If the goal-scoring rate is \(\lambda\), the probability of seeing an interval
    between goals of \(t\) is proportional to the PDF of the exponential distribution:'
  prefs: []
  type: TYPE_NORMAL
- en: \[\lambda \exp(-\lambda t)\]
  prefs: []
  type: TYPE_NORMAL
- en: Because \(t\) is a continuous quantity, the value of this expression is not
    a probability; it is a probability density. However, it is proportional to the
    probability of the data, so we can use it as a likelihood in a Bayesian update.
  prefs: []
  type: TYPE_NORMAL
- en: SciPy provides `expon`, which creates an object that represents an exponential
    distribution. However, it does not take `lam` as a parameter in the way you might
    expect, which makes it awkward to work with. Since the PDF of the exponential
    distribution is so easy to evaluate, I’ll use my own function.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE43]'
  prefs: []
  type: TYPE_PRE
- en: 'To see what the exponential distribution looks like, let’s assume again that
    `lam` is 1.4; we can compute the distribution of \(t\) like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE44]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE45]'
  prefs: []
  type: TYPE_PRE
- en: 'And here’s what it looks like:'
  prefs: []
  type: TYPE_NORMAL
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE46]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell source Hide code cell source</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE47]</details> ![_images/96ec4c44d1ecd930473d03903142cfd3b9249ca8650f4d696d5463fa14032e4b.png](../Images/bbb9f0b99d523d99aad1d28134d9c9a9.png)'
  prefs: []
  type: TYPE_NORMAL
- en: It is counterintuitive, but true, that the most likely time to score a goal
    is immediately. After that, the probability of each successive interval is a little
    lower.
  prefs: []
  type: TYPE_NORMAL
- en: With a goal-scoring rate of 1.4, it is possible that a team will take more than
    one game to score a goal, but it is unlikely that they will take more than two
    games.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'This chapter introduces three new distributions, so it can be hard to keep
    them straight. Let’s review:'
  prefs: []
  type: TYPE_NORMAL
- en: If a system satisfies the assumptions of a Poisson model, the number of events
    in a period of time follows a Poisson distribution, which is a discrete distribution
    with integer quantities from 0 to infinity. In practice, we can usually ignore
    low-probability quantities above a finite limit.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Also under the Poisson model, the interval between events follows an exponential
    distribution, which is a continuous distribution with quantities from 0 to infinity.
    Because it is continuous, it is described by a probability density function (PDF)
    rather than a probability mass function (PMF). But when we use an exponential
    distribution to compute the likelihood of the data, we can treat densities as
    unnormalized probabilities.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The Poisson and exponential distributions are parameterized by an event rate,
    denoted \(\lambda\) or `lam`.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: For the prior distribution of \(\lambda\), I used a gamma distribution, which
    is a continuous distribution with quantities from 0 to infinity, but I approximated
    it with a discrete, bounded PMF. The gamma distribution has one parameter, denoted
    \(\alpha\) or `alpha`, which is also its mean.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: I chose the gamma distribution because the shape is consistent with our background
    knowledge about goal-scoring rates. There are other distributions we could have
    used; however, we will see in <<_ConjugatePriors>> that the gamma distribution
    can be a particularly good choice.
  prefs: []
  type: TYPE_NORMAL
- en: But we have a few things to do before we get there, starting with these exercises.
  prefs: []
  type: TYPE_NORMAL
- en: Exercises
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**Exercise:** Let’s finish the exercise we started:'
  prefs: []
  type: TYPE_NORMAL
- en: In the 2014 FIFA World Cup, Germany played Brazil in a semifinal match. Germany
    scored after 11 minutes and again at the 23 minute mark. At that point in the
    match, how many goals would you expect Germany to score after 90 minutes? What
    was the probability that they would score 5 more goals (as, in fact, they did)?
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Here are the steps I recommend:'
  prefs: []
  type: TYPE_NORMAL
- en: Starting with the same gamma prior we used in the previous problem, compute
    the likelihood of scoring a goal after 11 minutes for each possible value of `lam`.
    Don’t forget to convert all times into games rather than minutes.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Compute the posterior distribution of `lam` for Germany after the first goal.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Compute the likelihood of scoring another goal after 12 more minutes and do
    another update. Plot the prior, posterior after one goal, and posterior after
    two goals.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Compute the posterior predictive distribution of goals Germany might score
    during the remaining time in the game, `90-23` minutes. Note: You will have to
    think about how to generate predicted goals for a fraction of a game.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Compute the probability of scoring 5 or more goals during the remaining time.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE48]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE49]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE50]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE51]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE52]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/0740f0e6f3f0aac3874b6c1f90f5771a7972aa50727a230b24702f1dc46f999f.png](../Images/d1fcdb7ef8f59f9372467e3f7169a89f.png)</details><details
    class="hide above-input"><summary aria-label="Toggle hidden content">Show code
    cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE53]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE54]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE55]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/0cecd0c7ba065fb6b2658efe96e68f30cb0ac638e3b23059c2fd7a58b1978682.png](../Images/cf03ebe34f639a6f56d7acd81816206b.png)</details><details
    class="hide above-input"><summary aria-label="Toggle hidden content">Show code
    cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE56]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE57]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE58]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE59]</details>'
  prefs: []
  type: TYPE_NORMAL
- en: '**Exercise:** Returning to the first version of the World Cup Problem. Suppose
    France and Croatia play a rematch. What is the probability that France scores
    first?'
  prefs: []
  type: TYPE_NORMAL
- en: 'Hint: Compute the posterior predictive distribution for the time until the
    first goal by making a mixture of exponential distributions. You can use the following
    function to make a PMF that approximates an exponential distribution.'
  prefs: []
  type: TYPE_NORMAL
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE60]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE61]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE62]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE63]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/c6056f1c8681d9a55bbb7434ffbf28fd8676cf8e71f1e833edec65ca92f43b2f.png](../Images/bc7bd8003dc80e838f43d3190f7ed3f4.png)</details><details
    class="hide above-input"><summary aria-label="Toggle hidden content">Show code
    cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE64]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE65]</details>'
  prefs: []
  type: TYPE_NORMAL
- en: '**Exercise:** In the 2010-11 National Hockey League (NHL) Finals, my beloved
    Boston Bruins played a best-of-seven championship series against the despised
    Vancouver Canucks. Boston lost the first two games 0-1 and 2-3, then won the next
    two games 8-1 and 4-0\. At this point in the series, what is the probability that
    Boston will win the next game, and what is their probability of winning the championship?'
  prefs: []
  type: TYPE_NORMAL
- en: To choose a prior distribution, I got some statistics from [http://www.nhl.com](http://www.nhl.com),
    specifically the average goals per game for each team in the 2010-11 season. The
    distribution is well modeled by a gamma distribution with mean 2.8.
  prefs: []
  type: TYPE_NORMAL
- en: In what ways do you think the outcome of these games might violate the assumptions
    of the Poisson model? How would these violations affect your predictions?
  prefs: []
  type: TYPE_NORMAL
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell content Hide code cell content</summary>
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE66]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE67]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE68]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE69]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE70]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/8961cb45c2d1db771b78e9c4b438312f7dce1565f33644f678a6f2463f8a0a2f.png](../Images/3575c4c5dd177b425f14969172ffe9c4.png)</details><details
    class="hide above-input"><summary aria-label="Toggle hidden content">Show code
    cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE71]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE72]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE73]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE74]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE75]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/c60ceceee189a52422bbfd1fa049ebb442236f4beb2ea4762ef515d24343ffbe.png](../Images/05d43fbce560d31a5916b25fb4940199.png)</details><details
    class="hide above-input"><summary aria-label="Toggle hidden content">Show code
    cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE76]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE77]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/aacd06863c73f0847d6ec939ef6c81a6bafb123c3163fd62b93fa43e0cf9d227.png](../Images/5bb78125c1a8e5bf4e5d784b719b0c13.png)</details><details
    class="hide above-input"><summary aria-label="Toggle hidden content">Show code
    cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE78]'
  prefs: []
  type: TYPE_PRE
- en: '![_images/325cc125fc2ae0889f9548b61f17be3f2cfd34d5a5f974a9951b5b3ffba5321f.png](../Images/5070d0fd39af5e813613121681f488d2.png)</details><details
    class="hide above-input"><summary aria-label="Toggle hidden content">Show code
    cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE79]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE80]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE81]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE82]</details> <details class="hide above-input"><summary aria-label="Toggle
    hidden content">Show code cell content Hide code cell content</summary>'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE83]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE84]</details>'
  prefs: []
  type: TYPE_NORMAL
